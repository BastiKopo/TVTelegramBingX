groups:
  - name: tvtelegrambingx.backend
    rules:
      - alert: TradingViewSignalBacklog
        expr: max_over_time(tvtelegrambingx_signal_queue_depth[5m]) > 10
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "TradingView signals are backing up"
          description: |
            More than 10 signals have been queued for execution for over 10 minutes.
            Investigate connectivity to BingX or Telegram approvals.
      - alert: BingXOrderFailures
        expr: increase(trading_orders_failed_total[15m]) > 3
        for: 15m
        labels:
          severity: critical
        annotations:
          summary: "BingX order submissions are failing"
          description: |
            More than three order submissions failed in the last 15 minutes.
            Check BingX API status and circuit breaker state.
      - alert: TradingViewIngestionLatency
        expr: histogram_quantile(0.95, rate(tradingview_signal_ingest_duration_seconds_bucket[10m])) > 5
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Signal ingestion is slow"
          description: |
            95th percentile TradingView ingestion latency exceeded five seconds.
            Inspect database health and broker connectivity.
  - name: tvtelegrambingx.bot
    rules:
      - alert: BotBackendReachability
        expr: increase(bot_backend_requests_total{status!~"2.."}[10m]) > 0
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Telegram bot cannot reach backend"
          description: |
            Bot backend requests are returning non-success codes.
            Verify network reachability and backend health.
